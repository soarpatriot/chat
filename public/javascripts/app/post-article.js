// Generated by CoffeeScript 1.6.3
/*
  this is used for user post one article
*/


(function() {
  require.config({
    baseUrl: '/javascripts',
    shim: {
      'bootstrap': {
        deps: ['jquery']
      },
      'underscore': {
        exports: '_'
      },
      'Showdown': {
        exports: 'Showdown'
      },
      'chosen': {
        exports: 'chosen'
      }
    },
    paths: {
      'jquery': 'jquery-1.9.1.min',
      'bootstrap': 'bootstrap.min',
      'Showdown': 'showdown',
      'chosen': 'chosen.jquery.min',
      'select2': 'select2',
      'jqBootstrapValidation': 'jqBootstrapValidation-1.3.7.min',
      'area': 'app/area',
      'underscore': 'underscore'
    }
  });

  require(['jquery', 'Showdown', 'underscore', 'area', 'bootstrap', 'chosen', 'select2', 'jqBootstrapValidation'], function($, Showdown, _, Area) {
    /*
     $("#tag-select").chosen({no_results_text: "没有匹配的查找项！"});
    */

    var converter, countries, country, options, _i, _len;
    $("#tag-select").select2();
    countries = _.map(Area, function(places, key) {
      return places;
    });
    options = "";
    for (_i = 0, _len = countries.length; _i < _len; _i++) {
      country = countries[_i];
      options += '<option value="' + country.id + '">' + country.text + '</option>';
    }
    $("#country-select").append(options);
    $("#country-select").select2();
    $("#country-select").on("change", function() {
      var district;
      country = $(this).val();
      district = _.map(Area[country].places, function(places, key) {
        return places;
      });
      return console.log(district);
    });
    $("input,select,textarea").not("[type=submit]").jqBootstrapValidation();
    converter = new Showdown.converter();
    return $("#editor-area").keyup(function() {
      var html, txt;
      txt = $("#editor-area").val();
      html = converter.makeHtml(txt);
      $("#preview-content").html(html);
      return $("#preview-content").html(html.replace(/>/g, ">\n").replace(/</g, "\n<").replace(/\n{2,}/g, "\n\n"));
    });
  });

}).call(this);
